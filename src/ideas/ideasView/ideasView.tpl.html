<md-card>
	<img ng-if="ideaHasImage()" ng-src="{{idea.image}}" class="md-card-image">
	<md-card-content>
		<h1>{{idea.title}}</h1>
		<h3>by {{idea.author}}</h3>
		<p>{{idea.description}}</p>
	</md-card-content>
</md-card>
<md-card>
	<md-card-content>
		<span flex ng-if="isUserLoggedIn() && !isUserLiked()">
			<md-button class="md-icon-button" aria-label="Like" ng-click="likeIdea()">
				<md-icon md-svg-icon="action:favorite_outline"></md-icon>
			</md-button>
		</span>
		<span flex ng-if="isUserLoggedIn() && isUserLiked()">
			<md-button class="md-icon-button" aria-label="Unlike" ng-click="unlikeIdea()">
				<md-icon md-svg-icon="action:favorite"></md-icon>
			</md-button>
		</span>
		<span flex>{{idea.likes.length}} <a class="idea-likes-click" ng-click="openLikes($event, idea.likes)">likes</a> and {{idea.backs.length}} backs</span>
	</md-card-content>
</md-card>
<md-card>
	<md-card-content>
		<md-tabs md-dynamic-height md-border-bottom>
			<md-tab label="Comments">
				<md-content class="md-padding">
					<md-list>
						<md-list-item class="md-2-line" ng-repeat="comment in idea.comments">
							<div class="md-list-item-text">
								<h3>{{comment.text}}</h3>
								<p>{{comment.from}} <small class="extra-space-left" ng-bind="momentizeTime(comment.time)"></small></p>
							</div>
						</md-list-item>
					</md-list>
					<div layout="row" ng-if="isUserLoggedIn()">
						<md-input-container id="comment-box-container" class="no-padding-bottom" flex>
							<label>Add a comment</label>
							<input id="comment-box" ng-model="ideasView.newComment" type="text" />
						</md-input-container>
						<md-button class="md-icon-button" aria-label="Submit" ng-disabled="ideasView.newComment === ''" ng-click="addNewInteraction('comments')">
					        <md-icon md-svg-icon="action:done"></md-icon>
						</md-button>
					</div>
				</md-content>
			</md-tab>
			<md-tab label="Backers">
				<md-content class="md-padding">
					<md-list>
						<md-list-item class="md-2-line" ng-repeat="back in idea.backs">
							<div class="md-list-item-text">
								<h3>{{back.text}}</h3>
								<p>
									{{back.from}} <small class="extra-space-left" ng-bind="momentizeTime(back.time)"></small>
									<span class="extra-space-left">
										<small class="custom-chip" ng-repeat="type in back.types">{{type.name}}</small>
									</span>
								</p>
								</span>
							</div>
						</md-list-item>
					</md-list>
					<div layout="row" ng-if="isUserLoggedIn()">
						<div layout="column" flex>
							<md-input-container id="back-box-container" class="no-padding-bottom">
								<label>Back this idea...</label>
								<input id="back-box" ng-model="ideasView.newBack" type="text" />
							</md-input-container>
							<md-chips ng-model="selectedTypes" md-autocomplete-snap md-require-match ng-show="ideasView.newBack">
								<md-autocomplete
									md-selected-item="selectedType"
									md-selected-item-change=""
									md-search-text="searchText"
									md-search-text-change=""
									md-items="type in querySearch(searchText)"
									md-item-text="type.name"
									placeholder="Type of backing">
									<span md-highlight-text="ctrl.searchText">{{type.name}}</span>
								</md-autocomplete>
								<md-chip-template>
									<span>
										<strong>{{$chip.name}}</strong>
									</span>
								</md-chip-template>
						    </md-chips>
						</div>
						<div layout="column" layout-align="center end">
							<md-button class="md-icon-button" aria-label="Submit" ng-disabled="ideasView.newBack === ''" ng-click="addNewInteraction('backs')">
						        <md-icon md-svg-icon="action:done"></md-icon>
							</md-button>
						</div>
					</div>
				</md-content>
			</md-tab>
			<!--<div layout="row" ng-if="isUserLoggedIn()==true">-->
				Please log in
			<!--</div>-->
		</md-tabs>
	</md-card-content>
</md-card>
